@inherits FluxorComponent

@inject IState<SettingsState> SettingsState

<dialog id="settingsDialog">

    <EditForm id="settings-form" Model="_request" OnValidSubmit="Save">

        <ValidationSummary />

        <div class="tz-row">Time Zone: <TimeZoneSelect @bind-Value="_request.TimeZoneId" /></div>

        <div class="database-row">
            <div>Loaded Databases: </div>

            <button class="button-primary" type="button" @onclick="ImportDatabase">
                <i class="bi bi-plus-circle"></i> Add Provider
            </button>
        </div>

        <div class="database-list">
            @if (_databases.Any())
            {
                @foreach (var database in _databases)
                {
                    <div class="database-row">
                        <span>@database</span>
                        <button class="button-remove" type="button" @onclick="() => DisableDatabase(database)">
                            <i class="bi bi-dash-circle"></i> Disable
                        </button>
                    </div>

                }
            }
            else
            {
                <p>None</p>
            }
        </div>
        
        @if (_request.DisabledDatabases.Any())
        {
            <div class="database-row">
                <div>Disabled Databases: </div>
            </div>

            <div class="database-list">
                @foreach (var database in _request.DisabledDatabases)
                {
                    <div class="database-row">
                        <span>@database</span>
                        <button class="button-save" type="button" @onclick="() => EnableDatabase(database)">
                            <i class="bi bi-plus-circle"></i> Enable
                        </button>
                    </div>
                }
            </div>
        }

        <div class="footer-group">
            <div class="prerelease-group">
                Pre-release Builds: <BooleanSelect @bind-Value="_request.IsPrereleaseEnabled" />
            </div>

            <div class="button-group">
                <button class="button-save" type="submit">Save</button>
                <button class="button-primary" type="button" @onclick="Close">Exit</button>
            </div>
        </div>

    </EditForm>

</dialog>
