@inherits FluxorComponent

@inject IState<SettingsState> SettingsState

<dialog id="settingsDialog">

    <EditForm id="settings-form" Model="_request" OnValidSubmit="Save">

        <ValidationSummary />

        <div class="tz-row">Time Zone: <TimeZoneSelect @bind-Value="_request.TimeZoneId" /></div>

        <div class="provider-row">
            <div>Loaded Providers: </div>

            <button class="button-primary" type="button" @onclick="ImportProvider">
                <i class="bi bi-plus-circle"></i> Add Provider
            </button>
        </div>

        <div class="provider-list">
            @if (_providers?.Any() is true)
            {
                @foreach (var provider in _providers)
                {
                    <div class="provider-row">
                        <span>@provider</span>
                        <button class="button-remove" type="button" @onclick="() => DisableProvider(provider)">
                            <i class="bi bi-dash-circle"></i> Disable
                        </button>
                    </div>

                }
            }
            else
            {
                <p>None</p>
            }
        </div>
        
        @if (_request.DisabledProviders?.Any() is true)
        {
            <div class="provider-row">
                <div>Disabled Providers: </div>
            </div>

            <div class="provider-list">
                @foreach (var provider in _request.DisabledProviders)
                {
                    <div class="provider-row">
                        <span>@provider</span>
                        <button class="button-save" type="button" @onclick="() => EnableProvider(provider)">
                            <i class="bi bi-plus-circle"></i> Enable
                        </button>
                    </div>
                }
            </div>
        }

        <div class="footer-group">
            <div class="prerelease-group">
                Pre-release Builds: <BooleanSelect @bind-Value="_request.IsPrereleaseEnabled" />
            </div>

            <div class="button-group">
                <button class="button-save" type="submit">Save</button>
                <button class="button-primary" type="button" @onclick="Close">Exit</button>
            </div>
        </div>

    </EditForm>

</dialog>
